<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RC2-CBC Encryption/Decryption</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>RC2-CBC Encryption/Decryption</h1>
        <p>Explore RC2 Cipher in CBC Mode</p>
    </header>
    
    <main>
        <div class="warning">
            <strong>Note:</strong> RC2 is considered cryptographically weak and should not be used for securing sensitive data.
        </div>
        
        <div class="card">
            <div class="tabs">
                <div class="tab active" onclick="switchTab('encrypt')">Encryption</div>
                <div class="tab" onclick="switchTab('decrypt')">Decryption</div>
            </div>
            
            <div id="encrypt" class="tab-content active">
                <h2>RC2-CBC Encryption</h2>
                
                
                <div class="form-group">
                    <label for="key-size">Key Size:</label>
                    <select id="key-size">
                        <option value="16">128-bit (16 bytes)</option>
                        <option value="12">96-bit (12 bytes)</option>
                        <option value="8">64-bit (8 bytes)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="encrypt-key">Key (hex):</label>
                    <div style="display: flex;">
                        <input type="text" id="encrypt-key" placeholder="Key will appear here">
                        <button onclick="generateKey('encrypt-key')" style="margin-left: 10px; width: 200px;">Generate Random Key</button>
                    </div>
                </div>
                
                
                <div class="form-group">
                    <label for="encrypt-iv">Initialization Vector (hex):</label>
                    <div style="display: flex;">
                        <input type="text" id="encrypt-iv" placeholder="IV will appear here">
                        <button onclick="generateIV('encrypt-iv')" style="margin-left: 10px; width: 200px;">Generate Random IV</button>
                    </div>
                </div>
                
                
                <div class="form-group">
                    <label for="plaintext">Message to Encrypt:</label>
                    <textarea id="plaintext" rows="3" placeholder="Enter your message here...">Hello World!</textarea>
                </div>
                
                <button onclick="simulateEncryption()" class="encrypt-btn">Encrypt</button>
                
                <div id="encryption-result" style="display: none;" class="result encrypt-result">
                    <h3>Encryption Results:</h3>
                    <div id="key-display"></div>
                    <div id="iv-display"></div>
                    <div id="padded-display"></div>
                    <div id="ciphertext-display"></div>
                </div>
            </div>
            
            
            <div id="decrypt" class="tab-content">
                <h2>RC2-CBC Decryption</h2>
                
                
                <div class="form-group">
                    <label for="decrypt-key">Key (hex):</label>
                    <div style="display: flex;">
                        <input type="text" id="decrypt-key" placeholder="Enter encryption key">
                        <!-- <button onclick="generateKey('decrypt-key')" style="margin-left: 10px; width: 200px;">Generate Random Key</button> -->
                    </div>
                </div>
                
                
                <div class="form-group">
                    <label for="decrypt-iv">Initialization Vector (hex):</label>
                    <div style="display: flex;">
                        <input type="text" id="decrypt-iv" placeholder="Enter encryption IV">
                        <!-- <button onclick="generateIV('decrypt-iv')" style="margin-left: 10px; width: 200px;">Generate Random IV</button> -->
                    </div>
                </div>
                
                
                <div class="form-group">
                    <label for="ciphertext">Ciphertext (hex):</label>
                    <textarea id="ciphertext" rows="3" placeholder="Enter ciphertext in hexadecimal format"></textarea>
                </div>
                
                <button onclick="simulateDecryption()" class="decrypt-btn">Decrypt</button>
                
                <div id="decryption-result" style="display: none;" class="result decrypt-result">
                    <h3>Decryption Results:</h3>
                    <div id="decrypted-display"></div>
                </div>
            </div>
        </div>
        
        <div class="card">
            <h2>About RC2-CBC Mode</h2>
            <p>RC2 is a block cipher with a 64-bit block size and variable key size. This demo uses RC2 in CBC mode, which requires an initialization vector (IV).</p>
            <p>The process works as follows:</p>
            <ol>
                <li><strong>Encryption:</strong> Generate a random key and IV, pad the plaintext to a multiple of the block size (8 bytes), then encrypt</li>
                <li><strong>Decryption:</strong> Use the same key and IV that were used for encryption to recover the original plaintext</li>
            </ol>
        </div>
    </main>
    
    <footer>
        <p>Sarnaavho Pal(23) | 3rd Year CSE(AIML) | 2022-26 | 12022002016036 | IEM, Kolkata</p>
    </footer>
    
    <script src="script.js"></script>
</body>
</html>